(function(P,u,F,t,e,A,k,r,R,n){"use strict";var i={Failed:r.getAssetIDByName("Small"),Delete:r.getAssetIDByName("ic_message_delete"),Copy:r.getAssetIDByName("toast_copy_link"),Open:r.getAssetIDByName("ic_leave_stage"),Clipboard:r.getAssetIDByName("pending-alert"),Clock:r.getAssetIDByName("clock"),Forum:r.getAssetIDByName("ic_forum_channel"),Settings:{Toasts:{Settings:r.getAssetIDByName("ic_selection_checked_24px"),Failed:r.getAssetIDByName("ic_close_circle_24px")},Initial:r.getAssetIDByName("coffee"),Update:r.getAssetIDByName("discover"),Locale:r.getAssetIDByName("ic_locale_24px"),External:r.getAssetIDByName("ic_raised_hand_list"),Edit:r.getAssetIDByName("ic_edit_24px"),Reply:r.getAssetIDByName("ic_reply_24px"),Keyboard:r.getAssetIDByName("ic_keyboard_24px")}},g={shadow:function(a=.1){return{shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:a,shadowRadius:4.65,elevation:8}},displayToast:function(a,s){e.toasts.open({content:s=="clipboard"?`Copied ${a} to clipboard.`:a,source:s=="clipboard"?i.Clipboard:i.Settings.Initial})}},m={plugin:{source:"https://github.com/S-cript-kiddie02/vendetta-plugins"},authors:{profile:{"Rosie<3":"https://github.com/acquitelol",MYSTRAVIL:"https://github.com/MYSTRAVIL/vendetta-plugins"}}};const{TouchableOpacity:S,View:v,Image:G,Text:U,Animated:B}=A.General,C=u.findByProps("transitionToGuild"),M=u.findByStoreName("UserStore"),V=u.findByProps("showUserProfile"),h=e.stylesheet.createThemedStyleSheet({container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",...g.shadow()},image:{width:75,height:75,borderRadius:10,...g.shadow()},mainText:{opacity:.975,letterSpacing:.25},header:{color:R.semanticColors.HEADER_PRIMARY,fontFamily:e.constants.Fonts.DISPLAY_BOLD,fontSize:25,letterSpacing:.25},subHeader:{color:R.semanticColors.HEADER_SECONDARY,fontSize:12.75}});function H({name:a,authors:s}){const o=e.React.useRef(new B.Value(1)).current,l=function(){return B.spring(o,{toValue:1.1,duration:10,useNativeDriver:!0}).start()},w=function(){return B.spring(o,{toValue:1,duration:250,useNativeDriver:!0}).start()},p=function(){return V.showUserProfile({userId:M.getCurrentUser().id})},d={transform:[{scale:o}]};return e.React.createElement(e.React.Fragment,null,e.React.createElement(v,{style:h.container},e.React.createElement(S,{onPress:p,onPressIn:l,onPressOut:w},e.React.createElement(B.View,{style:d},e.React.createElement(G,{style:[h.image],source:{uri:M?.getCurrentUser()?.getAvatarURL()?.replace("webp","png")}}))),e.React.createElement(v,{style:h.textContainer},e.React.createElement(S,{onPress:function(){return C.openURL(m.plugin.source)}},e.React.createElement(U,{style:[h.mainText,h.header]},a)),e.React.createElement(v,{style:{flexDirection:"row"}},e.React.createElement(U,{style:[h.mainText,h.subHeader]},"A project by"),s.map(function(y,E,b){return e.React.createElement(S,{onPress:function(){return C.openURL(m.author.profile[y.name]??"https://github.com/")}},e.React.createElement(U,{style:[h.mainText,h.subHeader,{paddingLeft:4,fontFamily:e.constants.Fonts.DISPLAY_BOLD,flexDirection:"row"}]},y.name,E<b.length-1?",":null))})))))}const{View:Y,Text:K}=A.General,N=e.stylesheet.createThemedStyleSheet({text:{color:R.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:12}});function O({label:a,children:s}){return e.React.createElement(Y,{style:{marginTop:10}},e.React.createElement(K,{style:[N.text,N.optionText]},a.toUpperCase()),s)}const{FormRow:c,FormSwitch:T,FormDivider:D,FormInput:W,FormText:j}=A.Forms,{ScrollView:z,View:x,Text:q}=A.General,f=e.stylesheet.createThemedStyleSheet({icon:{color:R.semanticColors.INTERACTIVE_NORMAL},item:{color:R.semanticColors.TEXT_MUTED,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM},container:{width:"90%",marginLeft:"5%",borderRadius:10,backgroundColor:R.semanticColors.BACKGROUND_MOBILE_SECONDARY,...g.shadow()},subheaderText:{color:R.semanticColors.HEADER_SECONDARY,textAlign:"center",margin:10,marginBottom:50,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:14},image:{width:"100%",maxWidth:350,borderRadius:10}});function X(){t.storage.tapUsernameMention===void 0&&(t.storage.tapUsernameMention=!1),t.storage.reply===void 0&&(t.storage.reply=!0),t.storage.userEdit===void 0&&(t.storage.userEdit=!0),t.storage.keyboardPopup===void 0&&(t.storage.keyboardPopup=!0),t.storage.delay===void 0&&(t.storage.delay="1000"),k.useProxy(t.storage);const a=e.ReactNative.Platform.OS==="android",s=function(l){/^\d*$/.test(l)&&(t.storage.delay=l)},o=function(){try{e.ReactNative.Linking&&e.ReactNative.Linking.openURL?e.ReactNative.Linking.openURL(m.plugin.source):g.displayToast("Cannot open URL: Linking not available","error")}catch(l){g.displayToast("Error opening URL","error"),console.error("Error opening URL:",l)}};return e.React.createElement(z,null,e.React.createElement(H,{name:t.manifest.name,authors:t.manifest.authors}),e.React.createElement(x,{style:{marginTop:20}},e.React.createElement(O,{label:"Preferences"},e.React.createElement(x,{style:[f.container]},e.React.createElement(c,{label:"Tap Username to Mention",subLabel:`Allows you to tap on a username to mention them instead of opening their profile.${a?" This option is disabled on Android.":""}`,onLongPress:function(){return g.displayToast("By default, Discord opens a profile when tapping on a username in chat. With this, it now mentions them, like on Android.","tooltip")},leading:e.React.createElement(c.Icon,{style:f.icon,source:t.storage.tapUsernameMention?i.Forum:i.Failed}),trailing:e.React.createElement(T,{value:a?!1:t.storage.tapUsernameMention,onValueChange:function(){a||(t.storage.tapUsernameMention=!t.storage.tapUsernameMention)}}),disabled:a}),e.React.createElement(D,null),e.React.createElement(c,{label:"Double Tap To Reply",subLabel:"Allows you to double tap on any messages to reply to them.",onLongPress:function(){return g.displayToast("Double tapping anyones message allows you to reply to them!","tooltip")},leading:e.React.createElement(c.Icon,{style:f.icon,source:t.storage.reply?i.Settings.Reply:i.Failed}),trailing:e.React.createElement(T,{value:t.storage.reply,onValueChange:function(){t.storage.reply=!t.storage.reply}})}),e.React.createElement(D,null),e.React.createElement(c,{label:"Open Keyboard Automatically",subLabel:"Opens the Keyboard when you reply to or edit a message with a double tap.",onLongPress:function(){return g.displayToast("Opens the Keyboard when you reply to or edit a message with a double tap.","tooltip")},leading:e.React.createElement(c.Icon,{style:f.icon,source:t.storage.keyboardPopup?i.Settings.Keyboard:i.Failed}),trailing:e.React.createElement(T,{value:t.storage.keyboardPopup,onValueChange:function(){t.storage.keyboardPopup=!t.storage.keyboardPopup}})}),e.React.createElement(D,null),e.React.createElement(c,{label:`${t.storage.userEdit?"Double tap to edit":"Double tap to reply to"} your own messages`,subLabel:`Allows you to double tap on any of your own messages to ${t.storage.userEdit?"edit":"reply to"} them.`,onLongPress:function(){return g.displayToast(`When double tapping on any of your own messages, you can now ${t.storage.userEdit?"edit them":"reply to them"}!`,"tooltip")},leading:e.React.createElement(c.Icon,{style:f.icon,source:t.storage.userEdit?i.Settings.Edit:i.Settings.Reply}),trailing:e.React.createElement(T,{value:t.storage.userEdit,onValueChange:function(){t.storage.userEdit=!t.storage.userEdit}})}),e.React.createElement(D,null),e.React.createElement(W,{value:t.storage.delay,onChange:s,placeholder:"1000",title:"Maximum Delay",keyboardType:"numeric"}),e.React.createElement(D,null),e.React.createElement(j,{style:{padding:10}},"The maximum delay between taps until the double tap event is cancelled. This is 300ms by default."))),e.React.createElement(O,{label:"Source"},e.React.createElement(x,{style:f.container},e.React.createElement(c,{label:"Source",subLabel:`Open the repository of ${t.manifest.name} externally.`,onLongPress:function(){return g.displayToast(`Opens the repository of ${t.manifest.name} on GitHub in an external page to view any source code of the plugin.`,"tooltip")},leading:e.React.createElement(c.Icon,{style:f.icon,source:i.Open}),trailing:function(){return e.React.createElement(c.Arrow,null)},onPress:o})))),e.React.createElement(q,{style:f.subheaderText},`Build: (${t.manifest.hash?.substring(0,8)||"dev"}`))}const J=u.findByStoreName("ChannelStore"),Q=u.findByStoreName("MessageStore"),Z=u.findByStoreName("UserStore"),ee=u.findByProps("sendMessage","startEditMessage"),te=u.findByProps("createPendingReply"),ae=u.findByProps("insertText");let L=u.findByProps("MessagesHandlers");if(!L){n.logger.warn("DEBUG: MessagesHandlers introuvable via props, tentative via cache...");const a=window.vendetta?.metro?.cache||new Map;for(const[s,o]of a)if(o?.exports?.MessagesHandlers){L=o.exports;break}}const $=L?.MessagesHandlers;function re(){try{const a=ae?.refs?.[0]?.current;a?.focus&&a.focus()}catch(a){console.log(a)}}const ne={patches:[],handlersPatched:new WeakSet,applyPatchToInstance(a,s){if(!this.handlersPatched.has(a))if(this.handlersPatched.add(a),n.logger.log(`DEBUG: Patching instance venant de ${s}`),a.handleDoubleTapMessage){const o=F.instead("handleDoubleTapMessage",a,function(l,w){n.logger.log("DEBUG: handleDoubleTapMessage D\xC9CLENCH\xC9 !");try{const p=l[0];if(!p||!p.nativeEvent)return n.logger.log("DEBUG: Pas de nativeEvent, on bloque."),!0;const{channelId:d,messageId:y}=p.nativeEvent;n.logger.log(`DEBUG: DoubleTap d\xE9tect\xE9 sur MsgID: ${y}`);const E=Q.getMessage(d,y),b=J.getChannel(d),_=Z.getCurrentUser();if(!E||!_)return n.logger.log("DEBUG: Message ou User introuvable"),!0;const I=E.author.id===_.id;return n.logger.log(`DEBUG: Auteur ? ${I} | Action: ${I?"Edit":"Reply"}`),I&&t.storage.userEdit?ee.startEditMessage(d,y,E.content||""):t.storage.reply&&te.createPendingReply({channel:b,message:E,shouldMention:!0}),re(),n.logger.log("DEBUG: Action termin\xE9e, return true pour bloquer Discord."),!0}catch(p){return n.logger.error("DEBUG: Crash dans le patch",p),!0}});this.patches.push(o)}else n.logger.warn("DEBUG: L'instance ne poss\xE8de pas handleDoubleTapMessage !")},onLoad(){var a,s;if(n.logger.log("DEBUG: Plugin Loaded"),!$){n.logger.error("DEBUG: FATAL - MessagesHandlers class introuvable.");return}(a=t.storage).reply??(a.reply=!0),(s=t.storage).userEdit??(s.userEdit=!0);const o=this,l=$.prototype,w=["params","handlers","_params"];let p=!1;for(const d of w){const y=Object.getOwnPropertyDescriptor(l,d);if(y&&y.get){n.logger.log(`DEBUG: Getter trouv\xE9 sur '${d}'`),p=!0;const E=y.get;Object.defineProperty(l,d,{configurable:!0,get(){const b=E.call(this);return b&&o.applyPatchToInstance(b,`getter:${d}`),b}}),this.patches.push(function(){Object.defineProperty(l,d,{configurable:!0,get:E})});break}}p||n.logger.error("DEBUG: Aucun getter trouv\xE9 sur le prototype ! Le patch global a \xE9chou\xE9.")},onUnload(){n.logger.log("DEBUG: Unloading..."),this.patches.forEach(function(a){return a()}),this.patches=[],this.handlersPatched=new WeakSet},settings:X};return P.default=ne,Object.defineProperty(P,"__esModule",{value:!0}),P})({},vendetta.metro,vendetta.patcher,vendetta.plugin,vendetta.metro.common,vendetta.ui.components,vendetta.storage,vendetta.ui.assets,vendetta.ui,vendetta);
