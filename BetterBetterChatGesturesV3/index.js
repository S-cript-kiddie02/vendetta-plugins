(function(C,d,k,t,e,S,V,r,E,m){"use strict";var u={Failed:r.getAssetIDByName("Small"),Delete:r.getAssetIDByName("ic_message_delete"),Copy:r.getAssetIDByName("toast_copy_link"),Open:r.getAssetIDByName("ic_leave_stage"),Clipboard:r.getAssetIDByName("pending-alert"),Clock:r.getAssetIDByName("clock"),Forum:r.getAssetIDByName("ic_forum_channel"),Settings:{Toasts:{Settings:r.getAssetIDByName("ic_selection_checked_24px"),Failed:r.getAssetIDByName("ic_close_circle_24px")},Initial:r.getAssetIDByName("coffee"),Update:r.getAssetIDByName("discover"),Locale:r.getAssetIDByName("ic_locale_24px"),External:r.getAssetIDByName("ic_raised_hand_list"),Edit:r.getAssetIDByName("ic_edit_24px"),Reply:r.getAssetIDByName("ic_reply_24px"),Keyboard:r.getAssetIDByName("ic_keyboard_24px")}},y={shadow:function(a=.1){return{shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:a,shadowRadius:4.65,elevation:8}},displayToast:function(a,o){e.toasts.open({content:o=="clipboard"?`Copied ${a} to clipboard.`:a,source:o=="clipboard"?u.Clipboard:u.Settings.Initial})}},L={plugin:{source:"https://github.com/S-cript-kiddie02/vendetta-plugins"},authors:{profile:{"Rosie<3":"https://github.com/acquitelol",MYSTRAVIL:"https://github.com/MYSTRAVIL/vendetta-plugins"}}};const{TouchableOpacity:M,View:_,Image:G,Text:x,Animated:v}=S.General,U=d.findByProps("transitionToGuild"),F=d.findByStoreName("UserStore"),Y=d.findByProps("showUserProfile"),g=e.stylesheet.createThemedStyleSheet({container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",...y.shadow()},image:{width:75,height:75,borderRadius:10,...y.shadow()},mainText:{opacity:.975,letterSpacing:.25},header:{color:E.semanticColors.HEADER_PRIMARY,fontFamily:e.constants.Fonts.DISPLAY_BOLD,fontSize:25,letterSpacing:.25},subHeader:{color:E.semanticColors.HEADER_SECONDARY,fontSize:12.75}});function K({name:a,authors:o}){const i=e.React.useRef(new v.Value(1)).current,n=function(){return v.spring(i,{toValue:1.1,duration:10,useNativeDriver:!0}).start()},R=function(){return v.spring(i,{toValue:1,duration:250,useNativeDriver:!0}).start()},l=function(){return Y.showUserProfile({userId:F.getCurrentUser().id})},c={transform:[{scale:i}]};return e.React.createElement(e.React.Fragment,null,e.React.createElement(_,{style:g.container},e.React.createElement(M,{onPress:l,onPressIn:n,onPressOut:R},e.React.createElement(v.View,{style:c},e.React.createElement(G,{style:[g.image],source:{uri:F?.getCurrentUser()?.getAvatarURL()?.replace("webp","png")}}))),e.React.createElement(_,{style:g.textContainer},e.React.createElement(M,{onPress:function(){return U.openURL(L.plugin.source)}},e.React.createElement(x,{style:[g.mainText,g.header]},a)),e.React.createElement(_,{style:{flexDirection:"row"}},e.React.createElement(x,{style:[g.mainText,g.subHeader]},"A project by"),o.map(function(s,b,h){return e.React.createElement(M,{onPress:function(){return U.openURL(L.author.profile[s.name]??"https://github.com/")}},e.React.createElement(x,{style:[g.mainText,g.subHeader,{paddingLeft:4,fontFamily:e.constants.Fonts.DISPLAY_BOLD,flexDirection:"row"}]},s.name,b<h.length-1?",":null))})))))}const{View:j,Text:W}=S.General,$=e.stylesheet.createThemedStyleSheet({text:{color:E.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:12}});function H({label:a,children:o}){return e.React.createElement(j,{style:{marginTop:10}},e.React.createElement(W,{style:[$.text,$.optionText]},a.toUpperCase()),o)}const{FormRow:p,FormSwitch:P,FormDivider:w,FormInput:z,FormText:q}=S.Forms,{ScrollView:X,View:N,Text:J}=S.General,f=e.stylesheet.createThemedStyleSheet({icon:{color:E.semanticColors.INTERACTIVE_NORMAL},item:{color:E.semanticColors.TEXT_MUTED,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM},container:{width:"90%",marginLeft:"5%",borderRadius:10,backgroundColor:E.semanticColors.BACKGROUND_MOBILE_SECONDARY,...y.shadow()},subheaderText:{color:E.semanticColors.HEADER_SECONDARY,textAlign:"center",margin:10,marginBottom:50,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:14},image:{width:"100%",maxWidth:350,borderRadius:10}});function Q(){t.storage.tapUsernameMention===void 0&&(t.storage.tapUsernameMention=!1),t.storage.reply===void 0&&(t.storage.reply=!0),t.storage.userEdit===void 0&&(t.storage.userEdit=!0),t.storage.keyboardPopup===void 0&&(t.storage.keyboardPopup=!0),t.storage.delay===void 0&&(t.storage.delay="1000"),V.useProxy(t.storage);const a=e.ReactNative.Platform.OS==="android",o=function(n){/^\d*$/.test(n)&&(t.storage.delay=n)},i=function(){try{e.ReactNative.Linking&&e.ReactNative.Linking.openURL?e.ReactNative.Linking.openURL(L.plugin.source):y.displayToast("Cannot open URL: Linking not available","error")}catch(n){y.displayToast("Error opening URL","error"),console.error("Error opening URL:",n)}};return e.React.createElement(X,null,e.React.createElement(K,{name:t.manifest.name,authors:t.manifest.authors}),e.React.createElement(N,{style:{marginTop:20}},e.React.createElement(H,{label:"Preferences"},e.React.createElement(N,{style:[f.container]},e.React.createElement(p,{label:"Tap Username to Mention",subLabel:`Allows you to tap on a username to mention them instead of opening their profile.${a?" This option is disabled on Android.":""}`,onLongPress:function(){return y.displayToast("By default, Discord opens a profile when tapping on a username in chat. With this, it now mentions them, like on Android.","tooltip")},leading:e.React.createElement(p.Icon,{style:f.icon,source:t.storage.tapUsernameMention?u.Forum:u.Failed}),trailing:e.React.createElement(P,{value:a?!1:t.storage.tapUsernameMention,onValueChange:function(){a||(t.storage.tapUsernameMention=!t.storage.tapUsernameMention)}}),disabled:a}),e.React.createElement(w,null),e.React.createElement(p,{label:"Double Tap To Reply",subLabel:"Allows you to double tap on any messages to reply to them.",onLongPress:function(){return y.displayToast("Double tapping anyones message allows you to reply to them!","tooltip")},leading:e.React.createElement(p.Icon,{style:f.icon,source:t.storage.reply?u.Settings.Reply:u.Failed}),trailing:e.React.createElement(P,{value:t.storage.reply,onValueChange:function(){t.storage.reply=!t.storage.reply}})}),e.React.createElement(w,null),e.React.createElement(p,{label:"Open Keyboard Automatically",subLabel:"Opens the Keyboard when you reply to or edit a message with a double tap.",onLongPress:function(){return y.displayToast("Opens the Keyboard when you reply to or edit a message with a double tap.","tooltip")},leading:e.React.createElement(p.Icon,{style:f.icon,source:t.storage.keyboardPopup?u.Settings.Keyboard:u.Failed}),trailing:e.React.createElement(P,{value:t.storage.keyboardPopup,onValueChange:function(){t.storage.keyboardPopup=!t.storage.keyboardPopup}})}),e.React.createElement(w,null),e.React.createElement(p,{label:`${t.storage.userEdit?"Double tap to edit":"Double tap to reply to"} your own messages`,subLabel:`Allows you to double tap on any of your own messages to ${t.storage.userEdit?"edit":"reply to"} them.`,onLongPress:function(){return y.displayToast(`When double tapping on any of your own messages, you can now ${t.storage.userEdit?"edit them":"reply to them"}!`,"tooltip")},leading:e.React.createElement(p.Icon,{style:f.icon,source:t.storage.userEdit?u.Settings.Edit:u.Settings.Reply}),trailing:e.React.createElement(P,{value:t.storage.userEdit,onValueChange:function(){t.storage.userEdit=!t.storage.userEdit}})}),e.React.createElement(w,null),e.React.createElement(z,{value:t.storage.delay,onChange:o,placeholder:"1000",title:"Maximum Delay",keyboardType:"numeric"}),e.React.createElement(w,null),e.React.createElement(q,{style:{padding:10}},"The maximum delay between taps until the double tap event is cancelled. This is 300ms by default."))),e.React.createElement(H,{label:"Source"},e.React.createElement(N,{style:f.container},e.React.createElement(p,{label:"Source",subLabel:`Open the repository of ${t.manifest.name} externally.`,onLongPress:function(){return y.displayToast(`Opens the repository of ${t.manifest.name} on GitHub in an external page to view any source code of the plugin.`,"tooltip")},leading:e.React.createElement(p.Icon,{style:f.icon,source:u.Open}),trailing:function(){return e.React.createElement(p.Arrow,null)},onPress:i})))),e.React.createElement(J,{style:f.subheaderText},`Build: (${t.manifest.hash?.substring(0,8)||"dev"}`))}const Z=d.findByStoreName("ChannelStore"),ee=d.findByStoreName("MessageStore"),te=d.findByStoreName("UserStore"),ae=d.findByProps("sendMessage","startEditMessage"),re=d.findByProps("createPendingReply"),ne=d.findByProps("insertText"),O=d.findByProps("dispatch","subscribe");let I;try{I=d.findByProps("MessagesHandlers")}catch{m.logger.warn("BetterChatGestures: Could not find MessagesHandlers via findByProps")}if(!I)try{const a=window.vendetta?.metro?.cache||new Map;for(const[o,i]of a)if(i?.exports?.MessagesHandlers){I=i.exports,m.logger.log("BetterChatGestures: Found MessagesHandlers via cache iteration");break}}catch(a){m.logger.error("BetterChatGestures: Failed to find MessagesHandlers via cache",a)}const B=I?.MessagesHandlers;let D=!1,T=null;const se={patches:[],handlersInstances:new WeakSet,openKeyboard(){if(t.storage.keyboardPopup)try{const a=ne?.refs?.[0]?.current;a?.focus&&a.focus()}catch{}},patchHandlers(a){var o=this;if(!(!a||typeof a!="object")&&!this.handlersInstances.has(a)&&(this.handlersInstances.add(a),a.handleDoubleTapMessage)){const i=k.instead("handleDoubleTapMessage",a,function(n,R){try{if(D=!0,T&&clearTimeout(T),T=setTimeout(function(){D=!1},500),!n?.[0]?.nativeEvent)return R.apply(a,n);const{nativeEvent:l}=n[0],c=l.channelId,s=l.messageId;if(!c||!s)return R.apply(a,n);const b=Z?.getChannel(c),h=ee?.getMessage(c,s);if(!h)return R.apply(a,n);const A=te?.getCurrentUser();return A&&h.author&&h.author.id===A.id&&t.storage.userEdit?ae?.startEditMessage(c,s,h.content||""):t.storage.reply&&b&&re?.createPendingReply({channel:b,message:h,shouldMention:!0}),o.openKeyboard(),!0}catch(l){return m.logger.error("BetterChatGestures: Error in handleDoubleTapMessage patch",l),D=!1,R.apply(a,n)}});this.patches.push(i)}},onLoad(){var a,o,i;if(!B){m.logger.error("BetterChatGestures: Plugin will not work (MessagesHandlers missing).");return}(a=t.storage).reply??(a.reply=!0),(o=t.storage).userEdit??(o.userEdit=!0),(i=t.storage).keyboardPopup??(i.keyboardPopup=!0);const n=this;if(O){const s=k.instead("dispatch",O,function(b,h){const A=b[0];if(!(D&&A&&A.type==="MESSAGE_REACTION_ADD"))return h.apply(O,b)});this.patches.push(s)}const R=["params","handlers","_params","messageHandlers"];let l=null,c=null;for(const s of R)if(l=Object.getOwnPropertyDescriptor(B.prototype,s)?.get,l){c=s;break}l&&c&&(Object.defineProperty(B.prototype,c,{configurable:!0,get(){const s=l.call(this);return s&&n.patchHandlers.call(n,s),s}}),this.patches.push(function(){try{l&&c&&Object.defineProperty(B.prototype,c,{configurable:!0,get:l})}catch{}}))},onUnload(){this.patches.forEach(function(a){return a?.()}),this.patches=[],this.handlersInstances=new WeakSet,D=!1,T&&clearTimeout(T)},settings:Q};return C.default=se,Object.defineProperty(C,"__esModule",{value:!0}),C})({},vendetta.metro,vendetta.patcher,vendetta.plugin,vendetta.metro.common,vendetta.ui.components,vendetta.storage,vendetta.ui.assets,vendetta.ui,vendetta);
